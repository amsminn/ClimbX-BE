<!DOCTYPE html>
<html lang="ko">
<head>
<<<<<<< HEAD
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ - ClimbX</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        
        .title {
            color: #333;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 16px;
            margin-bottom: 30px;
        }
        
        .step {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }
        
        .step-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .step-content {
            color: #555;
            line-height: 1.6;
        }
        
        button {
            background: linear-gradient(45deg, #FEE500, #FFEB3B);
            color: #3C1E1E;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            min-width: 200px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        button:disabled {
            background: #ccc;
            color: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            background: #e8f5e8;
            border: 1px solid #4CAF50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: left;
            display: none;
        }
        
        .error {
            background: #ffeaea;
            border: 1px solid #f44336;
            color: #d32f2f;
        }
        
        .info {
            background: #e3f2fd;
            border: 1px solid #2196F3;
            color: #1976d2;
        }
        
        .step.active {
            border-left-color: #4CAF50;
            background: #f0f8f0;
        }
        
        .step.completed {
            border-left-color: #4CAF50;
            background: #e8f5e8;
        }
        
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .token-info {
            margin: 10px 0;
        }
        
        .token-info strong {
            color: #333;
        }
    </style>
=======
<<<<<<< HEAD
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>ğŸ§ª ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ - ClimbX</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      max-width: 500px;
      width: 90%;
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .header h1 {
      color: #333;
      margin-bottom: 0.5rem;
      font-size: 1.8rem;
    }

    .header p {
      color: #666;
      font-size: 0.9rem;
    }

    .section {
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: #f8f9fa;
      border-radius: 12px;
      border: 1px solid #e9ecef;
    }

    .section h3 {
      color: #495057;
      margin-bottom: 1rem;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .form-group {
      margin-bottom: 1rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      color: #495057;
      font-weight: 500;
      font-size: 0.9rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #667eea;
    }

    .btn {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      margin: 0.25rem;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: linear-gradient(45deg, #6c757d, #495057);
    }

    .btn-secondary:hover {
      box-shadow: 0 4px 12px rgba(108, 117, 125, 0.4);
    }

    .btn-kakao {
      background: linear-gradient(45deg, #fee500, #ffcd00);
      color: #3c1e1e;
      font-weight: bold;
    }

    .btn-kakao:hover {
      box-shadow: 0 4px 12px rgba(254, 229, 0, 0.4);
    }

    .result-box {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      line-height: 1.4;
      max-height: 300px;
      overflow-y: auto;
      display: none;
    }

    .result-success {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }

    .result-error {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }

    .result-info {
      background: #d1ecf1;
      border: 1px solid #bee5eb;
      color: #0c5460;
    }

    .status {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: bold;
      margin-left: 0.5rem;
    }

    .status-connected {
      background: #d4edda;
      color: #155724;
    }

    .status-disconnected {
      background: #f8d7da;
      color: #721c24;
    }

    .token-display {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 6px;
      padding: 0.5rem;
      margin: 0.5rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
      word-break: break-all;
    }

    .api-test-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .step-indicator {
      display: flex;
      align-items: center;
      margin-bottom: 1rem;
    }

    .step-number {
      background: #667eea;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: bold;
      margin-right: 0.5rem;
    }
  </style>
>>>>>>> 4d7347d (refactor: ì¸ì¦ ê´€ë ¨ DTO, ì˜ˆì™¸ ì²˜ë¦¬, JWT í•„í„° ë° í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¦¬íŒ©í† ë§)
</head>
<body>
    <div class="container">
        <h1 class="title">ğŸ§ª ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h1>
        <p class="subtitle">ClimbX ì¸ì¦ ì‹œìŠ¤í…œ ê°œë°œì ë„êµ¬</p>
        
        <div class="step" id="step1">
            <div class="step-title">1ë‹¨ê³„: ì„œë²„ ì—°ê²° í™•ì¸</div>
            <div class="step-content">
                <p>ClimbX ë°±ì—”ë“œ ì„œë²„ ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
                <button onclick="checkServerConnection()" id="connectBtn">ğŸ”Œ ì„œë²„ ì—°ê²° í™•ì¸</button>
                <div id="connectionResult" class="result"></div>
            </div>
        </div>
        
        <div class="step" id="step2">
            <div class="step-title">2ë‹¨ê³„: ì¹´ì¹´ì˜¤ OAuth2 ì¸ì¦</div>
            <div class="step-content">
                <p>ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ë©ë‹ˆë‹¤.</p>
                <button onclick="startKakaoLogin()" id="loginBtn" disabled>ğŸ¯ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘</button>
                <div id="loginResult" class="result"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080/api';

        function showResult(elementId, message, isError = false, isInfo = false) {
            const element = document.getElementById(elementId);
            element.innerHTML = message;
            element.className = `result ${isError ? 'error' : isInfo ? 'info' : ''}`;
            element.style.display = 'block';
        }

        function setStepStatus(stepId, status) {
            const step = document.getElementById(stepId);
            step.className = `step ${status}`;
        }

<<<<<<< HEAD
        async function checkServerConnection() {
            try {
                setStepStatus('step1', 'active');
                showResult('connectionResult', 'ğŸ”„ ì„œë²„ ì—°ê²° í™•ì¸ ì¤‘...', false, true);
                
                const response = await fetch(`${API_BASE}/auth/oauth2/kakao/authorize-url`, {
                    method: 'GET',
                    redirect: 'manual' // ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬
                });
                
                if (response.type === 'opaqueredirect' || response.status === 302) {
                    showResult('connectionResult', 'âœ… ì„œë²„ ì—°ê²° ì„±ê³µ! ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    setStepStatus('step1', 'completed');
                    document.getElementById('loginBtn').disabled = false;
                    setStepStatus('step2', 'active');
                } else {
                    throw new Error(`ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ: ${response.status}`);
                }
            } catch (error) {
                showResult('connectionResult', `âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨: ${error.message}`, true);
                console.error('Connection error:', error);
            }
=======
  // í† í° ì •ë³´ í‘œì‹œ
  function displayTokenInfo() {
    const tokenInfoDiv = document.getElementById('tokenInfo');
    const tokenDisplayDiv = document.getElementById('tokenDisplay');

    tokenDisplayDiv.innerHTML = `
=======
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ - ClimbX</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 2rem;
            max-width: 500px;
            width: 90%;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }
        
        .header p {
            color: #666;
            font-size: 0.9rem;
        }
        
        .section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        
        .section h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #495057;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 0.25rem;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #495057);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.4);
        }
        
        .btn-kakao {
            background: linear-gradient(45deg, #fee500, #ffcd00);
            color: #3c1e1e;
            font-weight: bold;
        }
        
        .btn-kakao:hover {
            box-shadow: 0 4px 12px rgba(254, 229, 0, 0.4);
        }
        
        .result-box {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.4;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        
        .result-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .result-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .result-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        .status {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        .status-connected {
            background: #d4edda;
            color: #155724;
        }
        
        .status-disconnected {
            background: #f8d7da;
            color: #721c24;
        }
        
        .token-display {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            word-break: break-all;
        }
        
        .api-test-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .step-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h1>
            <p>ClimbX ë°±ì—”ë“œ API ê°œë°œìš© í…ŒìŠ¤íŠ¸ ë„êµ¬</p>
        </div>

        <!-- 1ë‹¨ê³„: ì—°ê²° í…ŒìŠ¤íŠ¸ -->
        <div class="section">
            <div class="step-indicator">
                <div class="step-number">1</div>
                <h3>ë°±ì—”ë“œ ì„œë²„ ì—°ê²°</h3>
            </div>
            
            <p style="margin-bottom: 1rem; color: #666; font-size: 0.9rem;">
                ë°±ì—”ë“œ ì„œë²„(http://localhost:8080)ì™€ì˜ ì—°ê²°ì„ í™•ì¸í•©ë‹ˆë‹¤.
            </p>
            
            <button class="btn btn-secondary" onclick="testConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
            <span id="configStatus" class="status status-disconnected">ë¯¸ì—°ê²°</span>
        </div>

        <!-- 2ë‹¨ê³„: ì¹´ì¹´ì˜¤ ì¸ì¦ -->
        <div class="section">
            <div class="step-indicator">
                <div class="step-number">2</div>
                <h3>ì¹´ì¹´ì˜¤ ì¸ì¦</h3>
            </div>
            
            <p style="margin-bottom: 1rem; color: #666; font-size: 0.9rem;">
                ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ì—¬ ì¸ê°€ ì½”ë“œë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤. (í™˜ê²½ë³€ìˆ˜ì— ì„¤ì •ëœ KAKAO_REST_API_KEY ì‚¬ìš©)
            </p>
            
            <button class="btn btn-kakao" onclick="startKakaoLogin()">
                ğŸ”‘ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘
            </button>
        </div>

        <!-- 3ë‹¨ê³„: ì¸ê°€ ì½”ë“œ ì²˜ë¦¬ -->
        <div class="section">
            <div class="step-indicator">
                <div class="step-number">3</div>
                <h3>ì¸ê°€ ì½”ë“œ ì²˜ë¦¬</h3>
            </div>
            
            <div class="form-group">
                <label for="authCode">Authorization Code</label>
                <input type="text" id="authCode" placeholder="ì¹´ì¹´ì˜¤ì—ì„œ ë°›ì€ ì¸ê°€ ì½”ë“œ">
            </div>
            
            <button class="btn btn-secondary" onclick="extractCodeFromUrl()">
                URLì—ì„œ ìë™ ì¶”ì¶œ
            </button>
            <button class="btn" onclick="exchangeToken()">
                í† í° êµí™˜ ìš”ì²­
            </button>
        </div>

        <!-- 4ë‹¨ê³„: API í…ŒìŠ¤íŠ¸ -->
        <div class="section">
            <div class="step-indicator">
                <div class="step-number">4</div>
                <h3>API í…ŒìŠ¤íŠ¸</h3>
            </div>
            
            <div id="tokenInfo" style="display: none;">
                <p><strong>ë°œê¸‰ëœ í† í°:</strong></p>
                <div class="token-display" id="tokenDisplay"></div>
            </div>
            
            <div class="api-test-buttons">
                <button class="btn" onclick="testUserInfo()">
                    ğŸ‘¤ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
                </button>
                <button class="btn" onclick="testRefreshToken()">
                    ğŸ”„ í† í° ê°±ì‹ 
                </button>
            </div>
        </div>

        <!-- ê²°ê³¼ í‘œì‹œ -->
        <div id="resultContainer">
            <div id="resultBox" class="result-box"></div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let config = {
            serverUrl: 'http://localhost:8080'
        };
        let tokens = {};

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            loadSavedConfig();
            checkUrlForCode();
        };

        // ì„¤ì • ì €ì¥/ë³µì›
        function saveConfig() {
            config.serverUrl = document.getElementById('serverUrl').value.trim();
            
            if (!config.serverUrl) {
                showResult('âŒ ë°±ì—”ë“œ ì„œë²„ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            localStorage.setItem('kakaoTestConfig', JSON.stringify(config));
            updateConfigStatus(true);
            showResult('âœ… ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
        }

        function loadSavedConfig() {
            const savedConfig = localStorage.getItem('kakaoTestConfig');
            if (savedConfig) {
                config = JSON.parse(savedConfig);
                document.getElementById('serverUrl').value = config.serverUrl;
                updateConfigStatus(true);
            }
        }

        function updateConfigStatus(isConfigured) {
            const statusElement = document.getElementById('configStatus');
            if (isConfigured) {
                statusElement.textContent = 'ì„¤ì •ì™„ë£Œ';
                statusElement.className = 'status status-connected';
            } else {
                statusElement.textContent = 'ë¯¸ì„¤ì •';
                statusElement.className = 'status status-disconnected';
            }
        }

        // ë°±ì—”ë“œ ì—°ê²° í…ŒìŠ¤íŠ¸
        async function testConnection() {
            if (!config.serverUrl) {
                showResult('âŒ ë¨¼ì € ë°±ì—”ë“œ ì„œë²„ URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            try {
                showResult('ğŸ”„ ë°±ì—”ë“œ ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');
                
                const response = await fetch(`${config.serverUrl}/api/auth/oauth2/kakao/authorize-url`);
                
                if (response.ok) {
                    showResult('âœ… ë°±ì—”ë“œ ì„œë²„ ì—°ê²° ì„±ê³µ! ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì¤€ë¹„ ì™„ë£Œ', 'success');
                } else {
                    showResult(`âŒ ë°±ì—”ë“œ ì„œë²„ ì—°ê²° ì‹¤íŒ¨ (${response.status})`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ë°±ì—”ë“œ ì„œë²„ ì—°ê²° ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘
        async function startKakaoLogin() {
            if (!config.serverUrl) {
                showResult('âŒ ë¨¼ì € ë°±ì—”ë“œ ì„œë²„ URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            try {
                showResult('ğŸ”„ ì¹´ì¹´ì˜¤ ì¸ì¦ URLì„ ìƒì„±í•˜ëŠ” ì¤‘...', 'info');
                
                const response = await fetch(`${config.serverUrl}/api/auth/oauth2/kakao/authorize-url`);
                
                if (response.ok) {
                    const result = await response.json();
                    const kakaoAuthUrl = result.body?.data || result.data || result;
                    
                    if (typeof kakaoAuthUrl !== 'string') {
                        showResult(`âŒ ì˜ëª»ëœ ì‘ë‹µ í˜•íƒœ: ${JSON.stringify(result, null, 2)}`, 'error');
                        return;
                    }
                    
                    showResult('ğŸ”„ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤...', 'info');
                    setTimeout(() => {
                        window.location.href = kakaoAuthUrl;
                    }, 1000);
                } else {
                    const errorText = await response.text();
                    showResult(`âŒ ì¹´ì¹´ì˜¤ ì¸ì¦ URL ìƒì„± ì‹¤íŒ¨ (${response.status})\n\n${errorText}`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // URLì—ì„œ ì¸ê°€ ì½”ë“œ í™•ì¸
        function checkUrlForCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            const error = urlParams.get('error');
            
            if (error) {
                showResult(`âŒ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì˜¤ë¥˜: ${error}`, 'error');
                return;
            }
            
            if (code) {
                document.getElementById('authCode').value = code;
                showResult(`âœ… ì¸ê°€ ì½”ë“œë¥¼ URLì—ì„œ ìë™ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤: ${code.substring(0, 20)}...`, 'success');
                
                // URL ì •ë¦¬ (ì½”ë“œ íŒŒë¼ë¯¸í„° ì œê±°)
                const cleanUrl = window.location.origin + window.location.pathname;
                window.history.replaceState({}, document.title, cleanUrl);
            }
        }

        function extractCodeFromUrl() {
            checkUrlForCode();
        }

        // í† í° êµí™˜
        async function exchangeToken() {
            const authCode = document.getElementById('authCode').value.trim();
            if (!authCode) {
                showResult('âŒ ì¸ê°€ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            if (!config.serverUrl) {
                showResult('âŒ ë°±ì—”ë“œ ì„œë²„ URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            try {
                showResult('ğŸ”„ í† í° êµí™˜ ìš”ì²­ ì¤‘...', 'info');
                
                const response = await fetch(`${config.serverUrl}/api/auth/oauth2/kakao/callback?code=${authCode}`);
                
                if (response.ok) {
                    tokens = await response.json();
                    displayTokenInfo();
                    showResult(`âœ… í† í° êµí™˜ ì„±ê³µ!
                    
- Token Type: ${tokens.tokenType}
- Expires In: ${tokens.expiresIn}ì´ˆ
- Access Token: ${tokens.accessToken.substring(0, 50)}...
- Refresh Token: ${tokens.refreshToken.substring(0, 50)}...`, 'success');
                } else {
                    const errorText = await response.text();
                    showResult(`âŒ í† í° êµí™˜ ì‹¤íŒ¨ (${response.status})\n\n${errorText}`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // í† í° ì •ë³´ í‘œì‹œ
        function displayTokenInfo() {
            const tokenInfoDiv = document.getElementById('tokenInfo');
            const tokenDisplayDiv = document.getElementById('tokenDisplay');
            
            tokenDisplayDiv.innerHTML = `
>>>>>>> 8947ec5 (refactor: ì¸ì¦ ê´€ë ¨ DTO, ì˜ˆì™¸ ì²˜ë¦¬, JWT í•„í„° ë° í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¦¬íŒ©í† ë§)
<strong>Access Token:</strong> ${tokens.accessToken.substring(0, 80)}...<br>
<strong>Refresh Token:</strong> ${tokens.refreshToken.substring(0, 80)}...<br>
<strong>Type:</strong> ${tokens.tokenType} | <strong>Expires:</strong> ${tokens.expiresIn}ì´ˆ
            `;
<<<<<<< HEAD

    tokenInfoDiv.style.display = 'block';
  }

  // ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ í…ŒìŠ¤íŠ¸
  async function testUserInfo() {
    if (!tokens.accessToken) {
      showResult('âŒ ë¨¼ì € í† í°ì„ ë°œê¸‰ë°›ì•„ì£¼ì„¸ìš”', 'error');
      return;
    }

    try {
      showResult('ğŸ”„ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì¤‘...', 'info');

      const response = await fetch(`${config.serverUrl}/api/auth/me`, {
        headers: {
          'Authorization': `Bearer ${tokens.accessToken}`,
          'Content-Type': 'application/json'
>>>>>>> 4d7347d (refactor: ì¸ì¦ ê´€ë ¨ DTO, ì˜ˆì™¸ ì²˜ë¦¬, JWT í•„í„° ë° í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¦¬íŒ©í† ë§)
        }

<<<<<<< HEAD
        function startKakaoLogin() {
            try {
                setStepStatus('step2', 'active');
                showResult('loginResult', 'ğŸ”„ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ ì¤‘...', false, true);
                
                // ì„œë²„ì—ì„œ ìë™ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•´ì£¼ë¯€ë¡œ ì§ì ‘ ì´ë™
                window.location.href = `${API_BASE}/auth/oauth2/kakao/authorize-url`;
                
            } catch (error) {
                showResult('loginResult', `âŒ ë¡œê·¸ì¸ ì‹œì‘ ì‹¤íŒ¨: ${error.message}`, true);
                console.error('Login start error:', error);
            }
        }
    </script>
=======
      if (response.ok) {
        const userInfo = await response.json();
        showResult(`âœ… ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì„±ê³µ!
                    
${JSON.stringify(userInfo, null, 2)}`, 'success');
      } else {
        const errorText = await response.text();
        showResult(`âŒ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨ (${response.status})\n\n${errorText}`, 'error');
      }
    } catch (error) {
      showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
    }
  }

  // í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸
  async function testRefreshToken() {
    if (!tokens.refreshToken) {
      showResult('âŒ ë¨¼ì € í† í°ì„ ë°œê¸‰ë°›ì•„ì£¼ì„¸ìš”', 'error');
      return;
    }

    try {
      showResult('ğŸ”„ í† í° ê°±ì‹  ì¤‘...', 'info');

      const response = await fetch(`${config.serverUrl}/api/auth/oauth2/refresh`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          refreshToken: tokens.refreshToken
        })
      });

      if (response.ok) {
        const result = await response.json();
        tokens = result.data || result;
        displayTokenInfo();
        showResult(`âœ… í† í° ê°±ì‹  ì„±ê³µ!
                    
- New Access Token: ${tokens.accessToken.substring(0, 50)}...
- New Refresh Token: ${tokens.refreshToken.substring(0, 50)}...`, 'success');
      } else {
        const errorText = await response.text();
        showResult(`âŒ í† í° ê°±ì‹  ì‹¤íŒ¨ (${response.status})\n\n${errorText}`, 'error');
      }
    } catch (error) {
      showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
    }
  }

  // ê²°ê³¼ í‘œì‹œ
  function showResult(message, type) {
    const resultBox = document.getElementById('resultBox');

    // íƒ€ì…ë³„ í´ë˜ìŠ¤ ì„¤ì •
    resultBox.className = `result-box result-${type}`;
    resultBox.textContent = message;
    resultBox.style.display = 'block';

    // ê²°ê³¼ ì˜ì—­ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
    resultBox.scrollIntoView({behavior: 'smooth', block: 'nearest'});
  }
</script>
=======
            
            tokenInfoDiv.style.display = 'block';
        }

        // ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ í…ŒìŠ¤íŠ¸
        async function testUserInfo() {
            if (!tokens.accessToken) {
                showResult('âŒ ë¨¼ì € í† í°ì„ ë°œê¸‰ë°›ì•„ì£¼ì„¸ìš”', 'error');
                return;
            }

            try {
                showResult('ğŸ”„ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì¤‘...', 'info');
                
                const response = await fetch(`${config.serverUrl}/api/auth/me`, {
                    headers: {
                        'Authorization': `Bearer ${tokens.accessToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const userInfo = await response.json();
                    showResult(`âœ… ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì„±ê³µ!
                    
${JSON.stringify(userInfo, null, 2)}`, 'success');
                } else {
                    const errorText = await response.text();
                    showResult(`âŒ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨ (${response.status})\n\n${errorText}`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸
        async function testRefreshToken() {
            if (!tokens.refreshToken) {
                showResult('âŒ ë¨¼ì € í† í°ì„ ë°œê¸‰ë°›ì•„ì£¼ì„¸ìš”', 'error');
                return;
            }

            try {
                showResult('ğŸ”„ í† í° ê°±ì‹  ì¤‘...', 'info');
                
                const response = await fetch(`${config.serverUrl}/api/auth/oauth2/refresh`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        refreshToken: tokens.refreshToken
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    tokens = result.data || result;
                    displayTokenInfo();
                    showResult(`âœ… í† í° ê°±ì‹  ì„±ê³µ!
                    
- New Access Token: ${tokens.accessToken.substring(0, 50)}...
- New Refresh Token: ${tokens.refreshToken.substring(0, 50)}...`, 'success');
                } else {
                    const errorText = await response.text();
                    showResult(`âŒ í† í° ê°±ì‹  ì‹¤íŒ¨ (${response.status})\n\n${errorText}`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(message, type) {
            const resultBox = document.getElementById('resultBox');
            
            // íƒ€ì…ë³„ í´ë˜ìŠ¤ ì„¤ì •
            resultBox.className = `result-box result-${type}`;
            resultBox.textContent = message;
            resultBox.style.display = 'block';
            
            // ê²°ê³¼ ì˜ì—­ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
            resultBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    </script>
>>>>>>> 8947ec5 (refactor: ì¸ì¦ ê´€ë ¨ DTO, ì˜ˆì™¸ ì²˜ë¦¬, JWT í•„í„° ë° í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¦¬íŒ©í† ë§)
>>>>>>> 4d7347d (refactor: ì¸ì¦ ê´€ë ¨ DTO, ì˜ˆì™¸ ì²˜ë¦¬, JWT í•„í„° ë° í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¦¬íŒ©í† ë§)
</body>
</html> 